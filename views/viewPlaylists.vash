@html.extend('layout', function(model) {
  @html.block('content', function(model) {

    <script src="scripts/viewPlaylists.js"></script>

    <h2 class="mb-3">Your Playlists</h2>
    <p>You currently have <strong>@model.totalNumberOfPlaylists</strong> playlists saved in Spotify!</p>

    <div id="playlistsPerPageSelector" class="align-items-center mb-4">
      <div class="input-group justify-content-center">
        <div class="dropdown input-group-prepend">
          <button id="playlistsPerPageDropdown" class="btn btn-outline-info btn-sm dropdown-toggle" type="button" data-toggle="dropdown">Playlists Per Page</button>
          <div class="dropdown-menu">
            @if(model.numberOfPlaylistsPerPage !== 10)
            {
              <a id="playlistsPerPageLink-10" class="dropdown-item" href="/playlists?playlistsPerPage=10">10</a>
            }
            else
            {
              <a class="dropdown-item disabled" href="#">10</a>
            }

            @if(model.numberOfPlaylistsPerPage !== 20)
            {
              <a id="playlistsPerPageLink-20" class="dropdown-item" href="/playlists?playlistsPerPage=20">20</a>
            }
            else
            {
              <a class="dropdown-item disabled" href="#">20</a>
            }

            @if(model.numberOfPlaylistsPerPage !== 30)
            {
              <a id="playlistsPerPageLink-30" class="dropdown-item" href="/playlists?playlistsPerPage=30">30</a>
            }
            else
            {
              <a class="dropdown-item disabled" href="#">30</a>
            }

            @if(model.numberOfPlaylistsPerPage !== 40)
            {
              <a id="playlistsPerPageLink-40" class="dropdown-item" href="/playlists?playlistsPerPage=40">40</a>
            }
            else
            {
              <a class="dropdown-item disabled" href="#">40</a>
            }

            @if(model.numberOfPlaylistsPerPage !== 50)
            {
              <a id="playlistsPerPageLink-50" class="dropdown-item" href="/playlists?playlistsPerPage=50">50</a>
            }
            else
            {
              <a class="dropdown-item disabled" href="#">50</a>
            }
          </div>
        </div>
        <div class="input-group-append">
          <label class="input-group-text" for="playlistsPerPageDropdown">@model.numberOfPlaylistsPerPage</label>
        </div>
      </div>
    </div>

    @if(model.playlists.length > 0)
    {
      <div id="playlists" class="table-responsive">
        <table class="table table-striped table-sm table-hover">
          <thead>
            <tr>
              <th scope="col" class="align-middle">Playlist #</th>
              <th scope="col" class="align-middle">Name</th>
              <th scope="col" class="align-middle">Owner</th>
              <th scope="col" class="align-middle">Link</th>
              <th scope="col" class="align-middle">Image</th>
            </tr>
          </thead>
          <tbody>
            @{
              var playlistCount = (model.currentPage - 1) * model.numberOfPlaylistsPerPage;
            }

            @model.playlists.forEach(function(item)
            {
              playlistCount++;

              <tr>
                <th scope="row" class="align-middle">@playlistCount</th>
                <td class="align-middle text-capitalize">@item.name</td>
                <td class="align-middle">@item.owner.display_name</td>
                <td class="align-middle col-md-2">
                  @{
                    var viewPlaylistLinkId = "viewPlaylistLink-" + playlistCount;
                  }
                  <a id="@viewPlaylistLinkId" href="/playlist?playlistId=@item.id" role="button" class="btn btn-outline-info btn-sm">View Playlist</a>
                </td>
                <td class="align-middle col-md-2">
                  @{
                    // Have to manually JSON stringify this object
                    // This is being done so that Vash at compile time can transfer data to JavaScript at run-time
                    // If we did not utilize JSON.stringify(), the default string output would be [object Object]
                    var imagesJson = JSON.stringify(item.images);

                    var playlistImageId = `imageForPlaylist-${playlistCount}`;
                    var minimumPixelsPerSide = 60;
                    var defaultImagePath = "images/question_small.png";
                  }
                  <img id="@playlistImageId" class="img-fluid" alt="Playlist Named @item.playlistName" />
                  <script type="text/javascript">
                    var images = @html.raw(imagesJson);
                    var playlistImagePath = getImagePath(images, @minimumPixelsPerSide, "@defaultImagePath");

                    setImageSourceAttributeById("@playlistImageId", playlistImagePath);
                  </script>
                </td>
              </tr>
            })
          </tbody>
        </table>
      </div>
    }

    <nav id="pages" class="my-5">
      <ul id="pageNavigationContainer" class="pagination justify-content-center">
        <script type="text/javascript">
          addPageNavigationButtons(@model.currentPage, @model.numberOfPlaylistsPerPage, @model.numberOfPages);
        </script>
      </ul>
    </nav>
  })
})
